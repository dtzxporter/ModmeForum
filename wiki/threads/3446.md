# ok so i have the 5 style teleports but when 2 players tp thay get downed
Game Modding | Call of Duty: Black Ops 3 | Scripting

---
<strong style="font-size: 1.4em;"><span style="text-decoration: underline;text-decoration-color: #34a7f9;"><span style="color:#34a7f9;">mrlednor</span></span>:</strong>

<p>how do i stop players getting sudden death ?<br />```<br />#using scripts\codescripts\struct; <br />#using scripts\shared\array_shared; <br />#using scripts\shared\callbacks_shared; <br />#using scripts\shared\clientfield_shared; <br />#using scripts\shared\compass; <br />#using scripts\shared\exploder_shared; <br />#using scripts\shared\flag_shared; <br />#using scripts\shared\laststand_shared; <br />#using scripts\shared\math_shared; <br />#using scripts\shared\scene_shared; <br />#using scripts\shared\util_shared; <br />#insert scripts\shared\shared.gsh; <br />#insert scripts\shared\version.gsh; <br />#insert scripts\zm\_zm_utility.gsh; <br />#using scripts\zm\_load;<br />#using scripts\zm\_util; <br />#using scripts\zm\_zm; <br />#using scripts\zm\_zm_audio; <br />#using scripts\zm\_zm_powerups; <br />#using scripts\zm\_zm_utility; <br />#using scripts\zm\_zm_weapons; <br />#using scripts\zm\_zm_zonemgr; <br />#using scripts\shared\ai\zombie_utility; <br />#using scripts\zm\_zm_spawner;<br />#define KINO_SWIRL                                  &quot;_NSZ/Kino_Tele/kino_swirl&quot;<br />#define TELE_BEAM                                    &quot;dlc0/factory/fx_teleporter_beam_factory&quot;<br />//*****************************************************************************************************************************<br />#define TARGET_DISTANCE                              1000 //Change to distance you want the zombies to get attracted to portal<br />//*****************************************************************************************************************************<br />#precache( &quot;fx&quot;, KINO_SWIRL );<br />#precache( &quot;fx&quot;, TELE_BEAM );<br />//-------------------------------------------------------------------------------<br />// setup and kick off think functions<br />//-------------------------------------------------------------------------------<br />function teleporter_init()<br />{<br />    thread teleport_pad_init();<br />}<br /><br />//-------------------------------------------------------------------------------<br />// handles turning on the pad.<br />//-------------------------------------------------------------------------------<br />function teleport_pad_init()<br />{    <br />    level.portal_trig = GetEntArray( &quot;portal_trigs&quot;, &quot;targetname&quot; );<br />    for ( i = 0; i &lt; level.portal_trig.size; i++ )<br />    {<br />            level.portal_trig<em>thread player_teleporting();<br />    }<br />}<br /><br />//-------------------------------------------------------------------------------<br />// handles moving the players and fx, etc...<br />//-------------------------------------------------------------------------------<br />function player_teleporting()<br />{<br />    while(true)<br />    {<br />        self waittill( &quot;trigger&quot;, player );<br />        <br />        //also allow when in last stand<br />        if ( zm_utility::is_player_valid( player ) || player laststand::player_is_in_laststand())<br />        {    <br />            self thread Teleport_Player(player);<br />        }<br /><br />    }<br />}<br /><br />//-------------------------------------------------------------------------------<br />//-------------------------------------------------------------------------------<br />function teleport_player(user)<br />{<br />    if(IsDefined(user.teleporting) &amp;&amp; user.teleporting == true)<br />    {<br />        return;<br />    }<br />    user.teleporting = true;<br />    self thread teleporting_zombies(user);<br />    PlayFX( TELE_BEAM, self.origin);<br />    self playsound( &quot;kino_beam_fx&quot; );<br />    rand = RandomFloatRange(0.9,0.3.);<br />    if(isdefined(self.target))<br />    {<br />        destination = struct::get(self.target, &quot;targetname&quot;);<br />        user setstance( &quot;stand&quot; );<br />        wait(0.1);<br />        //user playlocalsound( &quot;zmb_black_hole_bomb_teleporter_go&quot; );<br />        user DisableWeapons();<br />        user DisableOffhandWeapons();<br />        user freezecontrols( true );<br />        // trying to force angles on player.<br />        user SetOrigin( destination.origin * rand );<br />        user SetPlayerAngles( destination.angles );<br />        PlayFX( TELE_BEAM, user.origin);<br />        user playlocalsound( &quot;kino_teleport_2d&quot; );<br />    }<br />    else<br />    {        <br />        // script origin trigger destination targets for player placement.<br />        player_destination = struct::get(&quot;final_dest&quot;, &quot;targetname&quot;);<br />        user setstance( &quot;stand&quot; );<br />        wait(0.1);<br />        user playlocalsound( &quot;kino_teleport_2d&quot; );<br />        user DisableWeapons();<br />        user DisableOffhandWeapons();<br />        user freezecontrols( true );<br />        // trying to force angles on player.<br />        user SetOrigin( player_destination.origin * rand );<br />        user SetPlayerAngles( player_destination.angles );<br />        PlayFX( TELE_BEAM, user.origin);<br />    }<br />    wait(0.5);<br />    user enableweapons();<br />    user enableoffhandweapons();<br />    user FreezeControls( false );<br />    user.teleporting = false;<br />}<br /><br />//-------------------------------<br />// thread each zombie to teleport<br />//-------------------------------<br />function teleporting_zombies(user)<br />{<br />    zombie = GetAISpeciesArray(level.zombie_team, &quot;all&quot;);<br />    for(i = 0; i &lt; zombie.size; i++)<br />    {<br />        zombie<em>thread teleport_zombies(user, self);<br />    }<br />}<br />//--------------------------------<br />// self is zombies in zombie array<br />//--------------------------------<br />function teleport_zombies(targeted_player, target)<br />{<br />    self endon( &quot;death&quot; );<br />    //if zombie is too far just kill<br />    if(Distance(self.origin, target.origin) &gt;= TARGET_DISTANCE &amp;&amp; IsDefined(self.favoriteenemy) &amp;&amp; self.favoriteenemy == targeted_player)<br />    {<br />        level.zombie_total++;<br />        self DoDamage(self.health + 666, self.origin);<br />    }<br />    while(Distance(self.origin, target.origin) &lt; TARGET_DISTANCE &amp;&amp; IsDefined(self.favoriteenemy) &amp;&amp; self.favoriteenemy == targeted_player)<br />    {<br />        self.v_zombie_custom_goal_pos = target.origin;<br />        if(self.favoriteenemy != targeted_player)<br />        {<br />            self.v_zombie_custom_goal_pos = undefined;<br />        }<br />        if(Distance(self.origin, target.origin) &lt;= 50)<br />        {<br />            self thread zombie_touching(target, targeted_player);<br />            break;<br />        }<br />        wait(0.05);<br />    }<br />    self.v_zombie_custom_goal_pos = undefined;<br />}<br />//----------------------------------------<br />// if zombie is touching trigger, teleport<br />//----------------------------------------<br />function zombie_touching(portal_trig, targeted_player)<br />{<br />    zombie_origin = struct::get_array(&quot;zom_origin&quot;, &quot;targetname&quot;);<br />    if(self IsTouching(portal_trig))<br />    {<br />        PlayFX( TELE_BEAM, self.origin);<br />        portal_trig playsound( &quot;kino_beam_fx&quot; );<br />        closest = ArrayGetClosest(targeted_player.origin, zombie_origin);<br />        self forceteleport(closest.origin, closest.angles, false, true);<br />        //self.v_zombie_custom_goal_pos = undefined;<br />        PlayFX(TELE_BEAM, closest.origin);<br />        PlaySoundAtPosition( &quot;kino_beam_fx&quot; , closest.origin);<br />    }<br />    else<br />    {<br />        level.zombie_total++;<br />        self DoDamage(self.health + 666, self.origin);<br />        break;<br />    }<br />}```</em></em></p>
